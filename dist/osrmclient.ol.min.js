!function(e){function __webpack_require__(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,__webpack_require__),o.l=!0,o.exports}var t={};__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(e,t,r){"use strict";var o=function(e){return function(t){var r=e.split("."),o=r[0];window[o]||(window[o]={}),function constructObject(e,r){if(e.length>0){var o=e[0];r[o]||(r[o]={}),constructObject(e.splice(1),r[o])}else r[t.name]=t;return r}(r.splice(1),window[o])}};e.exports=o},function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o,n,i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),l=r(0),u=_interopRequireDefault(l),a=r(2);_interopRequireDefault(a),(o=(0,u.default)("M.plugin"))(n=function(e){function OSRMClient(e,t){_classCallCheck(this,OSRMClient);var r=_possibleConstructorReturn(this,(OSRMClient.__proto__||Object.getPrototypeOf(OSRMClient)).call(this));return r.e=null,r.t=void 0==e||""==e?"https://router.project-osrm.org/route/":e,r.r=t,r}return _inherits(OSRMClient,e),i(OSRMClient,[{key:"route",value:function(e,t,r){return(new M.control.OSRMClientControl).calculateRoute(e,t,r,this.t,this.r,this.e.getProjection().code,1e4)}},{key:"addTo",value:function(e){this.e=e,e.calculateRouteOsrm=this.route.bind(this)}}]),OSRMClient}(M.Plugin))},function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.OSRMClientControl=void 0;var o,n,i=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),l=r(0),u=_interopRequireDefault(l),a=r(3);_interopRequireDefault(a),t.OSRMClientControl=(o=(0,u.default)("M.control"))(n=function(e){function OSRMClientControl(){_classCallCheck(this,OSRMClientControl),M.utils.isUndefined(M.impl.control.OSRMClientControlImpl)&&M.exception("La implementación usada no puede crear controles OSRMClientControl");var e=new M.impl.control.OSRMClientControlImpl;return _possibleConstructorReturn(this,(OSRMClientControl.__proto__||Object.getPrototypeOf(OSRMClientControl)).call(this,e,"OSRMClient"))}return _inherits(OSRMClientControl,e),i(OSRMClientControl,[{key:"calculateRoute",value:function(e,t,r,o,n,i,l){return this.getImpl().calculateRoute(e,t,r,o,n,i,l)}}]),OSRMClientControl}(M.Control))||n},function(e,t,r){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.OSRMClientControlImpl=void 0;var o,n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),u=function get(e,t,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:get(n,t,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},a=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(a),s=(o=(0,c.default)("M.impl.control"))(n=function(e){function OSRMClientControlImpl(){return _classCallCheck(this,OSRMClientControlImpl),_possibleConstructorReturn(this,(OSRMClientControlImpl.__proto__||Object.getPrototypeOf(OSRMClientControlImpl)).call(this))}return _inherits(OSRMClientControlImpl,e),l(OSRMClientControlImpl,[{key:"addTo",value:function(e,t){u(OSRMClientControlImpl.prototype.__proto__||Object.getPrototypeOf(OSRMClientControlImpl.prototype),"addTo",this).call(this,e,t)}},{key:"calculateRoute",value:function(e,t,r,o,n,i,l){var u={};return u.fn=this.getPointsOfRoute.bind(this,e,t,r,o,n,i,l),u.then=function(e){try{e&&"function"==typeof e&&this.fn.bind(this,e)()}catch(e){M.dialog.error("error en la promesa: "+e,"Error")}},u}},{key:"getPointsOfRoute",value:function(e,t,r,o,n,l,u,a){var c=this,s=[];e.forEach(function(e){var t=e,r=new ol.geom.Point(ol.proj.transform([t[0],t[1]],l,"EPSG:4326"));s.push(r)});var f=[];s.forEach(function(e){var t=e,r=t.getCoordinates()[1],o=t.getCoordinates()[0],n={x:r,y:o};f.push(n)});var p=this.buildRouteURL(f,t,n,r,o),_=M.remote.get(p),d=u;this.timeOut=setTimeout(function(){M.dialog.error("No se ha podido calcular la ruta en este momento, por favor, intentelo mas tarde.","Error")},d);var h=this.decodeResponse.bind(this);_.then(function(e){clearTimeout(this.timeOut);var t=JSON.parse(e.text);if(200!=e.code)M.dialog.error("error realizando la petición entre dos puntos: "+p,"Error");else{var r=t.routes;if(r&&0===r.length)M.dialog.error("error realizando la petición entre dos puntos: "+p,"Error");else{var o=h(r[0].geometry,5,l);if(!o||"object"===(void 0===o?"undefined":i(o))&&o.length&&0===o.length)M.dialog.error("No se ha podido calcular la ruta en este momento, por favor, intentelo mas tarde.","Error");else if(o&&o.length&&o.length>0)return t.routeDecodified=o,a.call(this,t),!1}}a.call(this,[])}.bind(this)),_.catch(function(e){clearTimeout(c.timeOut),M.dialog.error("error realizando la petición entre dos puntos "+p,"Error")})}},{key:"buildRouteURL",value:function(e,t,r,o,n){var i={alternatives:["true","false"],steps:["true","false"],annotations:["true","false"],geometries:["polyline","geojson"],overview:["simplified","full","false"],continue_straight:["default","true","false"]},l="v1";void 0!=t?l=t:void 0!=r&&(l=r);for(var u=""+n+l+"/driving/",a=0;a<e.length;a++){var c=e[a];u=""+u+c.y+","+c.x,a+1<e.length&&(u+=";")}var s="";if(void 0!=o)for(key in o){var f=o[key],p=key;if(void 0!=i[p]){var _=i[p];_.includes(f)?u=1==u.includes("?")?u+"&"+p+"="+f:u+"?"+p+"="+f:s=s+" "+p+" - "+f+" "}else s=s+" "+p+" "}return""!=s&&M.dialog.error("Los siguientes parametros o valores no son validos por lo que no se incluirán en la petición "+s,"Error"),u}},{key:"locationKey",value:function(e){return e.x+","+e.y}},{key:"decodeResponse",value:function(e,t,r){var o=e.length,n=0,i=0,l=0,u=[];for(t=Math.pow(10,-t);n<o;){var a=void 0,c=0,s=0;do{a=e.charCodeAt(n++)-63,s|=(31&a)<<c,c+=5}while(a>=32);i+=1&s?~(s>>1):s>>1,c=0,s=0;do{a=e.charCodeAt(n++)-63,s|=(31&a)<<c,c+=5}while(a>=32);l+=1&s?~(s>>1):s>>1,u.push([i*t,l*t])}for(var f=[],p=0;p<u.length;p+=1){var _=new ol.geom.Point(ol.proj.transform([u[p][1],u[p][0]],"EPSG:4326",r)),d=[_.getCoordinates()[0],_.getCoordinates()[1]];f.push(d)}return f}}]),OSRMClientControlImpl}(M.impl.Control))||n;t.OSRMClientControlImpl=s}]),M.template.add("osrmclient.html",Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,r,o,n){return""},useData:!0}));